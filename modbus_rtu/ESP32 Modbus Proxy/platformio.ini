[env:d1_mini]
platform = espressif8266@4.2.1
board = d1_mini
framework = arduino
monitor_speed = 9600
upload_speed = 57600

; Libraries
lib_deps =
    ESP8266WiFi
    ESP8266WebServer
    ArduinoOTA

; Use specific Arduino Core version
board_build.arduino.upstream = https://github.com/esp8266/Arduino.git

; Upload settings for problematic boards
upload_flags = 
    --before=default_reset
    --after=hard_reset
    --connect-attempts=5
    --chip=esp8266
    --baud=57600

; Monitor settings
monitor_filters = default, esp8266_exception_decoder

; OTA Upload Environment
[env:d1_mini_ota]
platform = espressif8266@4.2.1
board = d1_mini
framework = arduino
upload_protocol = espota
upload_port = ESP8266-Modbus-Proxy.local
; Alternative: upload_port = 192.168.1.100  ; Use IP address if mDNS doesn't work
upload_flags =
    --auth=
    --port=8266

; Libraries (same as main environment)
lib_deps =
    ESP8266WiFi
    ESP8266WebServer
    ArduinoOTA